<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OctoDNS - How to manage DNS as code | Grimoire d'un Ops</title>
    <meta name="description" content="Découvrez comment gérer vos zones DNS comme du code avec OctoDNS, l'outil qui révolutionne la gestion DNS multi-fournisseurs. Un guide pratique pour automatiser et sécuriser votre infrastructure DNS.">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.DKhxSVUH.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.C6HuPXli.js"></script>
    <link rel="modulepreload" href="/assets/chunks/framework.DmvIer41.js">
    <link rel="modulepreload" href="/assets/blog_posts_octodns.md.DwfxSc2R.js">
    <link rel="modulepreload" href="/assets/chunks/katex.ChWnQ-fc.js">
    <link rel="modulepreload" href="/assets/chunks/dagre-OKDRZEBW.BHU5W3te.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-VJAJSXHY.v4G8uY3F.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-4HSFHLVR.CEbjhUO8.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-Q7BY3M3F.Tt0sR7M-.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-7IBYFJ6S.CfwyZGZY.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-APWFNJXF.DBMu2jnJ.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-PH2N3AL5.8zlMNxhY.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-IB7DONF6.iVDz5iZA.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-7GDLP6J5.ClEEPjmo.js">
    <link rel="modulepreload" href="/assets/chunks/xychartDiagram-VJFVF3MP.BIFPldrX.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-KVF5MWMF.DicXyeWr.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-X6HHIX6F.CrVsr5WU.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-GIVACNV2.1VbMTfWF.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-COTLJTTW.1VbMTfWF.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-DGXRK772.Bj3NOmv2.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-YXO3MK2T.BxXBIiPa.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-U35MCT3I.CNfJf6j5.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-BDJGKUSR.C7kXbpES.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-ALO5MXBD.LIZu3emh.js">
    <link rel="modulepreload" href="/assets/chunks/kanban-definition-NDS4AKOZ.DwJTExru.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-QLVOVGJD.rTuxrQYL.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-VNBRO52H.Bab3UEaS.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-SSKATNLV.BbPAY0wQ.js">
    <link rel="modulepreload" href="/assets/chunks/blockDiagram-JOT3LUYC.BvzwkSVd.js">
    <link rel="modulepreload" href="/assets/chunks/architectureDiagram-IEHRJDOE.CMfED6-u.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.B0W5t_E8.js">
    <link rel="modulepreload" href="/assets/chunks/VPLocalSearchBox.XxNWRrJj.js">
    <link rel="modulepreload" href="/assets/chunks/blog.data.BBMCr3gx.js">
    <link rel="modulepreload" href="/assets/blog_posts_octodns.md.DwfxSc2R.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5c483be3><!--[--><!--]--><!--[--><span tabindex="-1" data-v-5f5dec90></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-5f5dec90>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5c483be3 data-v-55af80a1><div class="VPNavBar" data-v-55af80a1 data-v-40b672e9><div class="wrapper" data-v-40b672e9><div class="container" data-v-40b672e9><div class="title" data-v-40b672e9><div class="VPNavBarTitle" data-v-40b672e9 data-v-3558ed7e><a class="title" href="/" data-v-3558ed7e><!--[--><!--]--><!----><span data-v-3558ed7e>Grimoire d&#39;un Ops</span><!--[--><!--]--></a></div></div><div class="content" data-v-40b672e9><div class="content-body" data-v-40b672e9><!--[--><!--]--><div class="VPNavBarSearch search" data-v-40b672e9><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-40b672e9 data-v-5a49d5b7><span id="main-nav-aria-label" class="visually-hidden" data-v-5a49d5b7> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-5a49d5b7 data-v-8ef6419a><!--[--><span data-v-8ef6419a>Accueil</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/" tabindex="0" data-v-5a49d5b7 data-v-8ef6419a><!--[--><span data-v-8ef6419a>Blog</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/projects/" tabindex="0" data-v-5a49d5b7 data-v-8ef6419a><!--[--><span data-v-8ef6419a>Projets</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/docs/" tabindex="0" data-v-5a49d5b7 data-v-8ef6419a><!--[--><span data-v-8ef6419a>Documentation</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-40b672e9 data-v-63450018><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-63450018 data-v-134aa140 data-v-d4a8e06b><span class="check" data-v-d4a8e06b><span class="icon" data-v-d4a8e06b><!--[--><span class="vpi-sun sun" data-v-134aa140></span><span class="vpi-moon moon" data-v-134aa140></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-40b672e9 data-v-299599a4 data-v-45e250a6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/zerka30" aria-label="github" target="_blank" rel="noopener" data-v-45e250a6 data-v-dada202e><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://www.linkedin.com/in/raphaelhien/" aria-label="linkedin" target="_blank" rel="noopener" data-v-45e250a6 data-v-dada202e><span class="vpi-social-linkedin"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-40b672e9 data-v-cdbb2844 data-v-85722fd5><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-85722fd5><span class="vpi-more-horizontal icon" data-v-85722fd5></span></button><div class="menu" data-v-85722fd5><div class="VPMenu" data-v-85722fd5 data-v-45685170><!----><!--[--><!--[--><!----><div class="group" data-v-cdbb2844><div class="item appearance" data-v-cdbb2844><p class="label" data-v-cdbb2844>Appearance</p><div class="appearance-action" data-v-cdbb2844><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-cdbb2844 data-v-134aa140 data-v-d4a8e06b><span class="check" data-v-d4a8e06b><span class="icon" data-v-d4a8e06b><!--[--><span class="vpi-sun sun" data-v-134aa140></span><span class="vpi-moon moon" data-v-134aa140></span><!--]--></span></span></button></div></div></div><div class="group" data-v-cdbb2844><div class="item social-links" data-v-cdbb2844><div class="VPSocialLinks social-links-list" data-v-cdbb2844 data-v-45e250a6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/zerka30" aria-label="github" target="_blank" rel="noopener" data-v-45e250a6 data-v-dada202e><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://www.linkedin.com/in/raphaelhien/" aria-label="linkedin" target="_blank" rel="noopener" data-v-45e250a6 data-v-dada202e><span class="vpi-social-linkedin"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-40b672e9 data-v-db37792f><span class="container" data-v-db37792f><span class="top" data-v-db37792f></span><span class="middle" data-v-db37792f></span><span class="bottom" data-v-db37792f></span></span></button></div></div></div></div><div class="divider" data-v-40b672e9><div class="divider-line" data-v-40b672e9></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-5c483be3 data-v-feaf3e8c><div class="container" data-v-feaf3e8c><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-feaf3e8c data-v-7cabf0e7><button data-v-7cabf0e7>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-5c483be3 data-v-3d3db84c><div class="post-layout" data-v-3d3db84c><div class="post-container"><div class="post-banner"><img src="/images/blog/octodns/cover.png" alt="OctoDNS - How to manage DNS as code" class="post-thumbnail"></div><div class="post-header"><div class="post-meta"><span class="post-date">29 avril 2025</span><span class="post-author"><span class="post-meta-separator">•</span><span class="post-author-name">Raphaël Hien</span></span></div><div class="post-tags"><!--[--><span class="post-tag" style="background-color:#9b59b6;">dns</span><span class="post-tag" style="background-color:#2ecc71;">as-code</span><!--]--></div><p class="post-description">Découvrez comment gérer vos zones DNS comme du code avec OctoDNS, l&#39;outil qui révolutionne la gestion DNS multi-fournisseurs. Un guide pratique pour automatiser et sécuriser votre infrastructure DNS.</p></div><div class="post-content vp-doc"><div style="position:relative;"><div><h1 id="octodns-how-to-manage-dns-as-code" tabindex="-1">OctoDNS - How to manage DNS as code <a class="header-anchor" href="#octodns-how-to-manage-dns-as-code" aria-label="Permalink to &quot;OctoDNS - How to manage DNS as code&quot;">​</a></h1><nav class="table-of-contents"><ul><li><a href="#introduction">Introduction</a><ul><li><a href="#qu-est-ce-que-octodns">Qu&#39;est ce que OctoDNS ?</a></li></ul></li><li><a href="#comment-ca-marche">Comment ça marche ?</a><ul><li><a href="#installation">Installation</a></li><li><a href="#configuration">Configuration</a></li></ul></li><li><a href="#utilisation">Utilisation</a><ul><li><a href="#automatisation">Automatisation</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul></nav><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><p>Dans le monde de l&#39;informatique moderne, de plus en plus d&#39;entreprise cherche à automatiser autant de tâches que possible. Cela permet de gagner du temps, de gagner en qualité, et d&#39;éviter de nombreuses erreurs humaines. Ces automatisations passent par la mise en place de système « as Code ».</p><p>C&#39;est pourquoi, j&#39;ai longtemps rêvé d&#39;un système qui me permettrait de gérer mes zones DNS de cette manière. L&#39;idée étant que quand je déploie un nouveau service, en quelques secondes, je puisse mettre à jour ma zones DNS pour que mon service soit accessible, sans devoir passer par les interfaces de mes fournisseurs qui sont toutes différentes, avec leurs spécificités propres.</p><h3 id="qu-est-ce-que-octodns" tabindex="-1">Qu&#39;est ce que OctoDNS ? <a class="header-anchor" href="#qu-est-ce-que-octodns" aria-label="Permalink to &quot;Qu&#39;est ce que OctoDNS ?&quot;">​</a></h3><p><a href="https://github.com/octodns/octodns" target="_blank" rel="noreferrer"><strong>OctoDNS</strong></a> est un outil open source écrit en python et développé par <a href="https://github.com/ross" target="_blank" rel="noreferrer">ross</a> qui permet de gérer ces zones DNS as code. Cette solution offre une approche complètement différente en reposant sur trois principes clés :</p><ol><li><strong>Configuration déclarative</strong> : Tous les enregistrements DNS sont définis dans des fichiers <code>.yml</code></li><li><strong>Source de vérité</strong> : Les fichiers YAML deviennent la référence absolue de notre configuration</li><li><strong>Abstraction des fournisseurs</strong> : Une syntaxe unifiée indépendante des spécificités de chaque provider</li></ol><p>L&#39;outil prend déjà en charge de nombreux fournisseurs DNS tels que :</p><ul><li>Amazon Route 53</li><li>Cloudflare</li><li>Google Cloud DNS</li><li>OVH</li><li>Infomaniak</li><li>Et bien d&#39;autres...</li></ul><p>Toutefois, si votre provider n&#39;est pas encore supporté, il vous sera très facile développer votre propre plugin pour l&#39;intégrer. La modularité est l&#39;un des atouts majeurs de cet outil, et sa base en Python rend le développement d&#39;extensions particulièrement accessible.</p><p>De plus, OctoDNS intègre également des fonctionnalités de validation et de prévisualisation des changements avant leur application, réduisant ainsi les risques d&#39;erreurs lors des modifications DNS.</p><h2 id="comment-ca-marche" tabindex="-1">Comment ça marche ? <a class="header-anchor" href="#comment-ca-marche" aria-label="Permalink to &quot;Comment ça marche ?&quot;">​</a></h2><p>Dans le cadre de cet article, nous allons mettre en place une configuration de base, en utilisant un unique provider : Infomaniak.</p><p>Toutefois, la configuration utilisée ici est parfaitement compatible avec d&#39;autres providers, et facilement adaptable pour la mise en place dans des environments plus complexes.</p><p>La structure de notre projet sera la suivante :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">octodns/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zones/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> home.zerka.dev.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> octodns.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> README.md</span></span></code></pre></div><p>Le point d&#39;entrée de notre configuration sera le fichier <code>octodns.yaml</code> qui contiendra la configuration globale de notre infrastructure. Et les fichiers de configurations seront respectivement définis dans le répertoire <code>zones/</code>.</p><h3 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h3><p>Pour commencer, nous devons installer OctoDNS. La documentation officielle nous incite explicitement à utiliser un environnement virtuel Python.</p><ol><li>Donc, on crée un environnement virtuel Python :</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv/bin/activate</span></span></code></pre></div><ol start="2"><li>On active l&#39;environnement virtuel :</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv/bin/activate</span></span></code></pre></div><ol start="3"><li>On installe OctoDNS :</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> octodns</span></span></code></pre></div><p>On peut ensuite vérifier que l&#39;installation s&#39;est bien passée en faisant un <code>octodns-sync --version</code> qui devrait nous retourner la version installée.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">octodns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">➜</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raphael@XPS-Raph:~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns-sync</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --version</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">octoDNS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.11.0</span></span></code></pre></div><p>Maintenant que nous avons installé OctoDNS, nous devons installer les différents plugins nécessaires pour supporter nos différents fournisseurs DNS.<br> Pour cela, il suffit de faire un <code>pip install octodns-&lt;provider&gt;</code>. Par exemple, pour mon cas, j&#39;utilise Infomaniak, j&#39;installe le plugin dédié avec la commande suivante :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> octodns-infomaniak</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Initialement, j&#39;avais commencé à développer le plugin <code>octodns-infomaniak</code> mais par manque de temps, c&#39;est <a href="https://github.com/M0NsTeRRR" target="_blank" rel="noreferrer">M0NsTeRRR</a> qui a redévelopper le plugin depuis zéro.<br> Merci à lui pour son travail !</p></div><p>Vous êtes maintenant prêt à gérer vos zones DNS avec OctoDNS !</p><h3 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h3><p>Maintenant, que notre installation est terminée, nous pouvons commencer à mettre en place notre configuration.</p><p>Pour commencer, nous devons créer un fichier de configuration principal qui servira de point d&#39;entrée pour toute notre configuration OctoDNS.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> octodns.yaml</span></span></code></pre></div><p>Ce fichier est composé de 2 grandes sections qui sont obligatoires :</p><ul><li><code>providers</code> : Cette section permet de configurer les fournisseurs DNS que nous utilisons.</li><li><code>zones</code> : Cette section permet de configurer les zones DNS que nous souhaitons gérer.</li></ul><h4 id="providers" tabindex="-1">Providers <a class="header-anchor" href="#providers" aria-label="Permalink to &quot;Providers&quot;">​</a></h4><p>La section <code>providers</code> permet de définir les différents fournisseurs DNS que nous souhaitons utiliser. Nous pouvons configurer autant de providers que nécessaire, tout en veillant à ce que chaque identifiant soit unique.</p><p>Par exemple, pour mon cas avec Infomaniak, voici ce que cela donnerais :</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">---</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">providers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  infomaniak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns_infomaniak.InfomaniakProvider</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">env/INFOMANIAK_TOKEN</span></span></code></pre></div><p>Dans cette configuration, nous définissons :</p><ul><li><code>infomaniak</code>: Correspondant à l&#39;identifiant de notre provider.</li><li><code>class</code>: La classe de notre provider, qui nous est fourni par la documentation de notre plugin.</li><li><code>token</code>: Le token qui nous permettra d&#39;accéder à l&#39;API d&#39;Infomaniak au travers d&#39;une variable d&#39;environnement nommée INFOMANIAK_TOKEN.</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Chaque provider définit ça propre structure de configuration. Il est donc nécessaire de se référer à la documentation de votre provider.</p></div><p>Dans la structure de notre projet, nous définissons un répertoire <code>zones</code> qui contient les fichiers de configuration pour chaque zone DNS que nous souhaitons gérer. Cela facilite la gestion des différentes zones DNS que nous souhaitons gérer, et améliore la lisibilité de notre configuration.</p><p>Nous devons donc définir un provider local qui nous permettra de lire les fichiers de configuration dans le répertoire <code>./zones</code>. Ce provider, c&#39;est le provider <code>yaml</code>.</p><p>On rajoute donc la configuration suivante dans notre fichier principal :</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">providers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns.provider.yaml.YamlProvider</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    directory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./zones</span></span></code></pre></div><h4 id="zones" tabindex="-1">Zones <a class="header-anchor" href="#zones" aria-label="Permalink to &quot;Zones&quot;">​</a></h4><p>La section <code>zones</code> dans notre fichier de configuration global permet de &quot;mapper&quot; les zones DNS avec les providers que nous avons défini dans la section <code>providers</code>.</p><p>Voici un exemple de configuration intéressante :</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">---</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">providers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">providers/infomaniak.yaml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns.provider.yaml.YamlProvider</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    directory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./zones</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">zones</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;zerka.dev.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">zerka</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    sources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">config</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    targets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">infomaniak</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;home.zerka.dev.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">zerka</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;cloud.zerka.dev.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">zerka</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;raphaelhien.fr.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">raphael</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    sources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">config</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    targets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">infomaniak</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;raphaelhien.ch.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    alias</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">raphaelhien.fr.</span></span></code></pre></div><p>Intéressons nous dans un premier temps à la zone <code>zerka.dev.</code>. Ici, je décris la zone <code>zerka.dev.</code>, en lui assignant comme source le provider <code>config</code> et comme target le provider <code>infomaniak</code>. En d&#39;autre termes, nous faisons référence au fichier de configuration dans le répertoire <code>./zones</code> pour la lecture et l&#39;écriture sur le provider <code>infomaniak</code>.</p><p>Ensuite, je décrit les zones <code>home.zerka.dev.</code> et <code>cloud.zerka.dev.</code> en utilisant l&#39;alias <code>&amp;zerka</code> défini précédemment, ce qui signifie que ces deux zones utiliseront la même configuration que la zone <code>zerka.dev.</code>.</p><p>Et enfin, je décris une zone <code>raphaelhien.fr.</code> comme la zone <code>zerka.dev.</code> mais qui pourrait ici très bien utiliser un provider différent. Et je défini un alias <code>raphaelhien.ch.</code> se qui veut dire que toutes les entrées de la zone <code>raphaelhien.fr.</code> seront automatiquement appliquées à la zone <code>raphaelhien.ch.</code>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Nous n&#39;avons ici, pas encore défini les enregistrements DNS pour chaque zone. Nous avons uniquement défini les sources et les targets pour chacune de nos zones.</p></div><h2 id="utilisation" tabindex="-1">Utilisation <a class="header-anchor" href="#utilisation" aria-label="Permalink to &quot;Utilisation&quot;">​</a></h2><p>Lorsque vous utilisez OctoDNS, il réalise un diff entre les enregistrements DNS actuellement définis (récupérés depuis le provider via l&#39;API) et les enregistrements DNS définis dans les fichiers de configuration. Si vous souhaitez donc migrer votre système de gestion actuel vers OctoDNS, il faut absolument redéfinir <em>tous</em> les enregistrements DNS dans les fichiers de configuration auquel cas vous risqueriez de perdre des enregistrements DNS.</p><p>Mais heureusement, OctoDNS nous permet de réaliser cette migration facilement avec la commande suivante qui va nous permettre de faire un dump intégral de notre zone DNS actuelle.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">octodns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">➜</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raphael@XPS-Raph:~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns-dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --config-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> octodns.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --output-dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./zones</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> home.zerka.dev.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> infomaniak</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Il faut tout de même que votre zone soit défini dans votre fichier de configuration global, afin que OctoDNS puisse lire les enregistrements DNS actuellement définis. Sinon, vous aurez une erreur de type <code>Unknown zone name home.zerka.dev.</code>.</p></div><p>Une fois que le dump est fait, nous pouvons donc commencer à gérer notre zone DNS sans trop de risque. Par exemple, ajoutons un enregistrement <code>CNAME</code> pour le service <code>demo.home.zerka.dev.</code> qui pointera vers <code>traefik.home.zerka.dev.</code>. On ajoute donc dans le fichier <code>home.zerka.dev.yaml</code> la configurations suivante :</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">demo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CNAME</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">traefik.home.zerka.dev.</span></span></code></pre></div><p>Puis, on vérifie que notre configuration est valide en lançant la commande suivante :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">octodns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">➜</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raphael@XPS-Raph:~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns-validate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --config-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> octodns.yaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> home.zerka.dev.</span></span></code></pre></div><p>Si tout est bon, nous pouvons lancer la commande suivante pour appliquer nos modifications :</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">octodns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">➜</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raphael@XPS-Raph:~/Workspace/octodns-blog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns-sync</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --config-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> octodns.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager __init__: config_file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns.yaml,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> (octoDNS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.11.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager _config_executor: max_workers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager _config_include_meta: include_meta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager _config_enable_checksum: enable_checksum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager _config_auto_arpa: auto_arpa</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager __init__: global_processors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager __init__: global_post_processors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager __init__: provider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">config</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> (octodns.provider.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.11.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager __init__: provider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">infomaniak</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> (octodns_infomaniak</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager sync: eligible_zones</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], eligible_targets</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], dry_run</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">True,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> force</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plan_output_fh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">stdout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> checksum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager sync:   zone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">home.zerka.dev.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager sync:     sources</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[&#39;config&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager sync:     processors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Manager sync:     targets</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[&#39;infomaniak&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  YamlProvider[config] populate:   found 12 records, exists</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  InfomaniakProvider[infomaniak] plan: desired</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">home.zerka.dev.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  InfomaniakProvider[infomaniak] populate:   found 11 records, exists</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  InfomaniakProvider[infomaniak] plan:   Creates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Updates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Deletes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Existing</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">11,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Meta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:48:12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [127034523914368] INFO  Plan</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********************************************************************************</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> home.zerka.dev.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********************************************************************************</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> infomaniak (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">InfomaniakProvider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   Create </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CnameRecord CNAME 3600, demo.home.zerka.dev., traefik.home.zerka.dev.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   Summary: Creates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Updates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Deletes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Existing</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">11,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Meta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********************************************************************************</span></span></code></pre></div><p>Cette commande nous permet de voir les changements qui seront appliqués. Ici, on voit bien que l&#39;on va crée un enregistrement <code>CNAME</code> pour le service <code>demo.home.zerka.dev.</code> qui pointera vers <code>traefik.home.zerka.dev.</code>. On peut donc appliquer les changements en rajoutant le flag <code>--doit</code> à la commande.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">octodns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">➜</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raphael@XPS-Raph:~/Workspace/octodns-blog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns-sync</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --config-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> octodns.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --doit</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager __init__: config_file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns.yaml,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> (octoDNS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.11.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager _config_executor: max_workers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager _config_include_meta: include_meta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager _config_enable_checksum: enable_checksum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager _config_auto_arpa: auto_arpa</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager __init__: global_processors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager __init__: global_post_processors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager __init__: provider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">config</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> (octodns.provider.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.11.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager __init__: provider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">infomaniak</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> (octodns_infomaniak</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager sync: eligible_zones</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], eligible_targets</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], dry_run</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> force</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plan_output_fh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">stdout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> checksum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager sync:   zone</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">home.zerka.dev.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager sync:     sources</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[&#39;config&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager sync:     processors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager sync:     targets</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[&#39;infomaniak&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  YamlProvider[config] populate:   found 12 records, exists</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  InfomaniakProvider[infomaniak] plan: desired</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">home.zerka.dev.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  InfomaniakProvider[infomaniak] populate:   found 11 records, exists</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  InfomaniakProvider[infomaniak] plan:   Creates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Updates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Deletes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Existing</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">11,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Meta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Plan</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********************************************************************************</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> home.zerka.dev.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********************************************************************************</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> infomaniak (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">InfomaniakProvider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   Create </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CnameRecord CNAME 3600, demo.home.zerka.dev., traefik.home.zerka.dev.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   Summary: Creates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Updates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Deletes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Existing</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">11,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Meta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********************************************************************************</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  InfomaniakProvider[infomaniak] apply: making 1 changes to home.zerka.dev.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  InfomaniakProvider[infomaniak] Create </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CnameRecord CNAME 3600, demo.home.zerka.dev., traefik.home.zerka.dev.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-04-29T14:49:30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [123934443401344] INFO  Manager sync:   1 total changes</span></span></code></pre></div><p>Si l&#39;on regarde notre zone DNS, sur l&#39;interface d&#39;Infomaniak, on voit bien que l&#39;enregistrement <code>CNAME</code> a été crée.</p><p><img src="/images/blog/octodns/infomaniak_zone.png" alt="Infomaniak"></p><h3 id="automatisation" tabindex="-1">Automatisation <a class="header-anchor" href="#automatisation" aria-label="Permalink to &quot;Automatisation&quot;">​</a></h3><p>Mais ce qui nous intéresse nous, c&#39;est pas d&#39;avoir a effectuer ces changements manuellement. Nous souhaitons que ces changements soit effectué automatiquement. Pour cela, nous allons mettre en place un pipeline CI/CD qui va nous permettre de détecter les changements sur nos services et de les appliquer automatiquement.</p><p>On définit donc un pipeline Gitlab CI/CD qui va nous permettre de détecter les changements sur nos services et de les appliquer automatiquement.</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">---</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">stages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">test</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">deploy</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">variables</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  INFOMANIAK_TOKEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">${INFOMANIAK_TOKEN}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">.rules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rule-mr</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$CI_PIPELINE_SOURCE == &#39;merge_request_event&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">on_success</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rule-branch</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  stage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">test</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">python:3.9-slim</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  before_script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pip install octodns octodns-infomaniak</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns-sync --config octodns.yaml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  rules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rule-mr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rule-branch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">deploy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  stage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">deploy</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">python:3.9-slim</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  before_script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pip install octodns octodns-infomaniak</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">octodns-sync --config octodns.yaml --doit</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  rules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rule-branch</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">on_success</span></span></code></pre></div><p>Ce pipeline contient 2 jobs, dans un premier temps, le job <code>test</code> qui va nous permettre de valider notre configuration et de nous assurer que tout est bon. Et dans un second temps, le job <code>deploy</code> qui va nous permettre d&#39;appliquer nos changements.</p><p>Ces jobs sont conditionnés par 2 règles :</p><ul><li><code>rule-mr</code> : Cette règle va nous permettre de détecter les changements sur une merge request</li><li><code>rule-branch</code> : Cette règle va nous permettre de détecter les changements sur la branche principale</li></ul><p>On a donc une solution très simple et efficace pour gérer nos zones DNS avec OctoDNS de manière automatisée.</p><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>OctoDNS représente une véritable solution pour gérer ses zones DNS en adoptant une approche &quot;as code&quot;. Il nous permet de :</p><ul><li><strong>Centraliser</strong> toutes nos configurations DNS dans un format unifié</li><li><strong>Automatiser</strong> les déploiements via des pipelines CI/CD</li><li><strong>Sécuriser</strong> nos modifications grâce aux validations et prévisualisations</li><li><strong>Standardiser</strong> nos pratiques indépendamment des fournisseurs utilisés</li></ul><p>Dans un monde où l&#39;infrastructure as code devient la norme, OctoDNS s&#39;impose comme une solution incontournable pour les équipes DevOps en permettant d&#39;intégrer la gestion DNS dans les workflows d&#39;automatisation, réduisant ainsi les erreurs humaines tout en accélérant les déploiements conformément aux pratiques DevOps actuelles.</p></div></div></div></div></div></div><footer class="VPFooter" data-v-5c483be3 data-v-e231f2bc><div class="container" data-v-e231f2bc><p class="message" data-v-e231f2bc>Made with ❤️ by Raphaël</p><p class="copyright" data-v-e231f2bc>Copyright © 2025</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"blog_index.md\":\"DIb6apfS\",\"blog_posts_octodns.md\":\"DwfxSc2R\",\"docs_index.md\":\"0Eb5AY8K\",\"docs_python_index.md\":\"Ckflaiho\",\"docs_python_ruff.md\":\"CDK3SXaz\",\"index.md\":\"BnJMvZQI\",\"projects_index.md\":\"Tn-8nTw9\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Grimoire d'un Ops\",\"description\":\"Pratiques, astuces, rituels et incantations.\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Accueil\",\"link\":\"/\"},{\"text\":\"Blog\",\"link\":\"/blog/\"},{\"text\":\"Projets\",\"link\":\"/projects/\"},{\"text\":\"Documentation\",\"link\":\"/docs/\"}],\"sidebar\":{\"/docs/\":{\"base\":\"/docs/\",\"items\":[{\"text\":\"Python\",\"items\":[{\"text\":\"Ruff - A better alternative to flake8, black, isort, ...\",\"link\":\"python/ruff\"}],\"collapsed\":false}]}},\"search\":{\"provider\":\"local\"},\"footer\":{\"message\":\"Made with ❤️ by Raphaël\",\"copyright\":\"Copyright © 2025\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/zerka30\"},{\"icon\":\"linkedin\",\"link\":\"https://www.linkedin.com/in/raphaelhien/\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>